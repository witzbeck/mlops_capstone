FROM ghcr.io/mlflow/mlflow:v2.12.2

RUN pip3 install psycopg2-binary sqlalchemy --no-cache-dir

# ARG POSTGRES_HOST
# ARG POSTGRES_PORT
# ARG MLFLOW_EXPERIMENT_NAME
# ARG MLFLOW_ARTIFACT_URI
# ARG MLFLOW_TRACKING_URI
# ARG MLFLOW_TRACKING_HOST
# ARG MLFLOW_TRACKING_PORT
# ARG MLFLOW_TRACKING_NAME
# ARG MLFLOW_TRACKING_USER
# ARG MLFLOW_TRACKING_PASSWORD
ARG MLFLOW_STORE_URI

# Set the environment variables
# ENV POSTGRES_HOST=$POSTGRES_HOST
# ENV POSTGRES_PORT=$POSTGRES_PORT
# ENV MLFLOW_EXPERIMENT_NAME=$MLFLOW_EXPERIMENT_NAME
# ENV MLFLOW_ARTIFACT_URI=$MLFLOW_ARTIFACT_URI
# ENV MLFLOW_TRACKING_URI=$MLFLOW_TRACKING_URI
# ENV MLFLOW_TRACKING_HOST=$MLFLOW_TRACKING_HOST
ENV MLFLOW_TRACKING_PORT=$MLFLOW_TRACKING_PORT
ENV MLFLOW_TRACKING_NAME=$MLFLOW_TRACKING_NAME
ENV MLFLOW_TRACKING_USER=$MLFLOW_TRACKING_USER
ENV MLFLOW_TRACKING_PASSWORD=$MLFLOW_TRACKING_PASSWORD
ENV MLFLOW_STORE_URI=$MLFLOW_STORE_URI

# Set the working directory
WORKDIR /mlflow
